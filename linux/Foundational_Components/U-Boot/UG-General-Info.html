

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.1.1.1. General Information &mdash; Processor SDK Linux for J721e Documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Processor SDK Linux for J721e Documentation" href="../../../index.html"/>
        <link rel="up" title="3.1.1. User’s Guide" href="Users-Guide.html"/>
        <link rel="next" title="3.1.1.2. USB Device Firmware Upgrade (DFU)" href="UG-DFU.html"/>
        <link rel="prev" title="3.1.1. User’s Guide" href="Users-Guide.html"/> 
  <script src="https://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">
  <header id="tiHeader">
    <div class="top">
      <ul>
        <li id="top_logo">
          <a href="http://www.ti.com">
            <img src="../../../_static/img/ti_logo.png"/>
          </a>
        </li>
      </ul>
    </div>
    <div class="nav"></div>
  </header>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../devices/J7_Family/linux/index.html" class="icon icon-home"> Processor SDK Linux for J721e
          

          
          </a>

          
            
            
              <div class="version">
                09_00_00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devices/J7_Family/linux/Release_Specific.html">2. Release Specific</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Foundational_Components.html">3. Foundational Components</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../Foundational_Components_U-Boot.html">3.1. U-Boot</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="Users-Guide.html">3.1.1. User’s Guide</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">3.1.1.1. General Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-DFU.html">3.1.1.2. USB Device Firmware Upgrade (DFU)</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-Network.html">3.1.1.3. Network (Wired or USB Client)</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-NAND.html">3.1.1.4. NAND</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-Memory.html">3.1.1.5. SD, eMMC and USB</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-SPI.html">3.1.1.6. SPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-QSPI.html">3.1.1.7. OSPI/QSPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-NOR.html">3.1.1.8. NOR</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-UART.html">3.1.1.9. UART</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-SATA.html">3.1.1.10. SATA</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-UFS.html">3.1.1.11. UFS</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-DDR3.html">3.1.1.12. DDR3 ECC</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-HyperBus.html">3.1.1.13. HyperBus and HyperFlash</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-RemoteProc.html">3.1.1.14. RemoteProc</a></li>
<li class="toctree-l4"><a class="reference internal" href="UG-AVS.html">3.1.1.15. Adaptive Voltage Scaling (AVS) Class 0</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Applications.html">3.1.2. Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Kernel.html">3.2. Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Filesystem.html">3.3. Filesystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Tools.html">3.4. Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_IPC_J721E.html">3.5. IPC for J721E</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Graphics.html">3.6. Graphics and Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Multimedia_D5520_VXE384.html">3.7. Multimedia Video Codec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_Virtualization.html">3.8. Virtualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_ATF.html">3.9. ARM Trusted Firmware-A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Foundational_Components_OPTEE.html">3.10. OP-TEE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../How_to_Guides.html">4. How to Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Documentation_Tarball.html">5. Documentation Tarball</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../devices/J7_Family/linux/index.html">Processor SDK Linux for J721e</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../devices/J7_Family/linux/index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../Foundational_Components.html"><span class="section-number">3. </span>Foundational Components</a> &raquo;</li>
      
          <li><a href="../../Foundational_Components_U-Boot.html"><span class="section-number">3.1. </span>U-Boot</a> &raquo;</li>
      
          <li><a href="Users-Guide.html"><span class="section-number">3.1.1. </span>User’s Guide</a> &raquo;</li>
      
    <li><span class="section-number">3.1.1.1. </span>General Information</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="general-information">
<h1><span class="section-number">3.1.1.1. </span>General Information<a class="headerlink" href="#general-information" title="Permalink to this headline">¶</a></h1>
<div class="section" id="getting-the-u-boot-source-code">
<h2><span class="section-number">3.1.1.1.1. </span>Getting the U-Boot Source Code<a class="headerlink" href="#getting-the-u-boot-source-code" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The easiest way to get access to the U-boot source code is by
downloading and installing the Processor SDK Linux. Once installed,
the U-Boot source code is included in the SDK’s board-support
directory. For your convenience the sources also includes the U-Boot’s
git repository including commit history.</div>
<div class="line">Alternatively, U-Boot sources can directly be fetched from GIT.</div>
</div>
<blockquote>
<div></div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="build-u-boot">
<span id="build-u-boot-label"></span><h2><span class="section-number">3.1.1.1.2. </span>Build U-Boot<a class="headerlink" href="#build-u-boot" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following commands are intended to be run from the root of the
U-Boot tree unless otherwise specified. The root of the U-Boot tree is
the top-level directory and can be identified by looking for the
“MAINTAINERS” file.</p>
</div>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note about HSM Rearchitecture</p>
<p>After HSM rearchitecture in bootloader, loading of remote cores with firmware
will be supported at A72 SPL stage only and not at R5 SPL stage. Early loading
of remote core firmware in R5 SPL requires core reset functionality. As part
of HSM rearchitecture, this functionality has moved into the DM service which
requires SPL to re-implement device and clock control. This support is not
present in Uboot R5 SPL due to memory constraints on the existing 64-bit TI devices.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of Processor SDK 9.0, compilation of bootloader images will no longer require
different defconfigs for GP and HS devices. The same build commands will generate images
for GP, HS-SE and HS-FS devices.</p>
</div>
<p>Several prebuilt images are required from the TI Processor SDK for building U-Boot on K3 based platforms.</p>
<p>TI-u-boot is included in the SDK in &lt;path to tisdk&gt;/board-support. Ensure that the u-boot version matches the
<span class="xref std std-ref">release-specific-build-information-u-boot</span>.</p>
<p class="rubric">Setting the tool chain path</p>
<p>We strongly recommend using the toolchain that came with the Linux Core
release that corresponds to this U-Boot release. For e.g:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>export PATH=$HOME/gcc-arm-9.2-2019.12-x86_64-arm-none-linux-gnueabihf/bin:$PATH
export PATH=$HOME/gcc-arm-9.2-2019.12-x86_64-aarch64-none-linux-gnu/bin:$PATH
</pre></div>
</div>
<p class="rubric">Compiling R5 and ARM64 images</p>
<p>Use the following table to determine what defconfig to use to configure with:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Board</p></th>
<th class="head"><p>SD/eMMC Boot</p></th>
<th class="head"><p>UART boot</p></th>
<th class="head"><p>OSPI boot</p></th>
<th class="head"><p>Hyper Flash</p></th>
<th class="head"><p>USB DFU</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>J721E EVM</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
</tr>
<tr class="row-odd"><td><p>J721E SK</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td><p>j721e_evm_r5_defconfig
j721e_evm_a72_defconfig</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">R5</span>
<span class="gp">$ </span>make <span class="nv">ARCH</span><span class="o">=</span>arm <span class="nv">CROSS_COMPILE</span><span class="o">=</span>arm-none-linux-gnueabihf- j721e_evm_r5_defconfig <span class="nv">O</span><span class="o">=</span>&lt;output directory&gt;/r5
<span class="gp">$ </span>make <span class="nv">ARCH</span><span class="o">=</span>arm <span class="nv">CROSS_COMPILE</span><span class="o">=</span>arm-none-linux-gnueabihf- <span class="nv">O</span><span class="o">=</span>&lt;output directory&gt;/r5 <span class="nv">BINMAN_INDIRS</span><span class="o">=</span>&lt;path to tisdk&gt;/board-support/prebuilt-images


<span class="go">A72</span>
<span class="gp">$ </span>make <span class="nv">ARCH</span><span class="o">=</span>arm <span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu- j721e_evm_a72_defconfig <span class="nv">O</span><span class="o">=</span>&lt;output directory&gt;/a72
<span class="gp">$ </span>make <span class="nv">ARCH</span><span class="o">=</span>arm <span class="nv">CROSS_COMPILE</span><span class="o">=</span>aarch64-none-linux-gnu- <span class="nv">BL31</span><span class="o">=</span>&lt;path to tisdk&gt;/board-support/prebuilt-images/bl31.bin <span class="nv">TEE</span><span class="o">=</span>&lt;path to tisdk&gt;/board-support/prebuilt-images/bl32.bin <span class="nv">O</span><span class="o">=</span>&lt;output directory&gt;/a72 <span class="nv">BINMAN_INDIRS</span><span class="o">=</span>&lt;path to tisdk&gt;/board-support/prebuilt-images
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>BINMAN_INDIRS is used to fetch the DM binary from board-support/prebuilt-images/ti-dm/ and SYSFW binaries from board-support/prebuilt-images/ti-sysfw/. If not using the SDK, BINMAN_INDIRS can point to either ti-linux-firmware or any folder where DM is located in &lt;path to folder&gt;/ti-dm/ and SYSFW binaries are present in &lt;path to folder&gt;/ti-sysfw/. Please make sure to use the absolute path.</p>
</div>
<p class="rubric" id="target-images">Target Images</p>
<p>Copy the below images to the boot partition of an SD card and boot.
Instructions to format the SD card can be found <a class="reference external" href="../../Overview/Processor_SDK_Linux_create_SD_card.html">here</a>.</p>
<ul class="simple">
<li><p>GP</p>
<ul>
<li><p>tiboot3-j721e-gp-evm.bin, sysfw-j721e-gp-evm.itb from &lt;output directory&gt;/r5</p></li>
<li><p>tispl.bin_unsigned, u-boot.img_unsigned from &lt;output directory&gt;/a53</p></li>
</ul>
</li>
<li><p>HS-FS</p>
<ul>
<li><p>tiboot3-j721e_sr2-hs-fs-evm.bin, sysfw-j721e_sr2-hs-fs-evm.itb from &lt;output directory&gt;/r5</p></li>
<li><p>tispl.bin, u-boot.img from &lt;output directory&gt;/a53</p></li>
</ul>
</li>
<li><p>HS-SE</p>
<ul>
<li><p>tiboot3-j721e_sr2-hs-evm.bin, sysfw-j721e_sr2-hs-evm.itb from &lt;output directory&gt;/r5</p></li>
<li><p>tispl.bin, u-boot.img from &lt;output directory&gt;/a53</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="image-formats">
<h2><span class="section-number">3.1.1.1.3. </span>Image Formats<a class="headerlink" href="#image-formats" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>tiboot3.bin</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-----------------------+</span>
<span class="go">|        X.509          |</span>
<span class="go">|      Certificate      |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |        R5         | |</span>
<span class="go">| |   u-boot-spl.bin  | |</span>
<span class="go">| |                   | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |     FIT header    | |</span>
<span class="go">| | +---------------+ | |</span>
<span class="go">| | |               | | |</span>
<span class="go">| | |   DTB 1...N   | | |</span>
<span class="go">| | +---------------+ | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">+-----------------------+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>tispl.bin</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-----------------------+</span>
<span class="go">|                       |</span>
<span class="go">|       FIT HEADER      |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |      A72 ATF      | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |     A72 OPTEE     | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |      R5 DM FW     | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |      A72 SPL      | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |   SPL DTB 1...N   | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">+-----------------------+</span>
</pre></div>
</div>
<ul class="simple">
<li><p>sysfw.itb</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+-----------------------+</span>
<span class="go">|                       |</span>
<span class="go">|       FIT HEADER      |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |     sysfw.bin     | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |    board config   | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |     PM config     | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |     RM config     | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">| |                   | |</span>
<span class="go">| |    Secure config  | |</span>
<span class="go">| +-------------------+ |</span>
<span class="go">+-----------------------+</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="boot-flow">
<h2><span class="section-number">3.1.1.1.4. </span>Boot Flow<a class="headerlink" href="#boot-flow" title="Permalink to this headline">¶</a></h2>
<p>On K3 architecture based devices, ROM supports boot only via MCU(R5). This means that
bootloader has to run on R5 core. In order to meet this constraint, keeping
safety in picture and to have faster boot time, the software boot architecture
is designed as below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">+------------------------------------------------------------------------+-----------------------+</span>
<span class="go">|        DMSC            |      MCU R5           |        A72            |  MAIN R5/C66x/C7x     |</span>
<span class="go">+------------------------------------------------------------------------+-----------------------+</span>
<span class="go">|    +--------+          |                       |                       |                       |</span>
<span class="go">|    |  Reset |          |                       |                       |                       |</span>
<span class="go">|    +--------+          |                       |                       |                       |</span>
<span class="go">|         :              |                       |                       |                       |</span>
<span class="go">|    +--------+          |   +-----------+       |                       |                       |</span>
<span class="go">|    | *ROM*  |----------|--&gt;| Reset rls |       |                       |                       |</span>
<span class="go">|    +--------+          |   +-----------+       |                       |                       |</span>
<span class="go">|    |        |          |         :             |                       |                       |</span>
<span class="go">|    |  ROM   |          |         :             |                       |                       |</span>
<span class="go">|    |services|          |         :             |                       |                       |</span>
<span class="go">|    |        |          |   +-------------+     |                       |                       |</span>
<span class="go">|    |        |          |   |  *R5 ROM*   |     |                       |                       |</span>
<span class="go">|    |        |          |   +-------------+     |                       |                       |</span>
<span class="go">|    |        |&lt;---------|---|Load and auth|     |                       |                       |</span>
<span class="go">|    |        |          |   | tiboot3.bin |     |                       |                       |</span>
<span class="go">|    |        |          |   +-------------+     |                       |                       |</span>
<span class="go">|    |        |          |         :             |                       |                       |</span>
<span class="go">|    |        |          |         :             |                       |                       |</span>
<span class="go">|    |        |          |         :             |                       |                       |</span>
<span class="go">|    |        |          |   +-------------+     |                       |                       |</span>
<span class="go">|    |        |          |   |  *R5 SPL*   |     |                       |                       |</span>
<span class="go">|    |        |          |   +-------------+     |                       |                       |</span>
<span class="go">|    |        |          |   |    Load     |     |                       |                       |</span>
<span class="go">|    |        |          |   |  sysfw.itb  |     |                       |                       |</span>
<span class="go">|    | Start  |          |   +-------------+     |                       |                       |</span>
<span class="go">|    | System |&lt;---------|---|    Start    |     |                       |                       |</span>
<span class="go">|    |Firmware|          |   |    SYSFW    |     |                       |                       |</span>
<span class="go">|    +--------+          |   +-------------+     |                       |                       |</span>
<span class="go">|        :               |   |             |     |                       |                       |</span>
<span class="go">|    +---------+         |   |   Load      |     |                       |                       |</span>
<span class="go">|    | *SYSFW* |         |   |   system    |     |                       |                       |</span>
<span class="go">|    +---------+         |   | Config data |     |                       |                       |</span>
<span class="go">|    |         |&lt;--------|---|             |     |                       |                       |</span>
<span class="go">|    |         |         |   +-------------+     |                       |                       |</span>
<span class="go">|    |         |         |   |    DDR      |     |                       |                       |</span>
<span class="go">|    |         |         |   |   config    |     |                       |                       |</span>
<span class="go">|    |         |         |   +-------------+     |                       |                       |</span>
<span class="go">|    |         |         |   |    Load     |     |                       |                       |</span>
<span class="go">|    |         |         |   |  tispl.bin  |     |                       |                       |</span>
<span class="go">|    |         |         |   +-------------+     |                       |                       |</span>
<span class="go">|    |         |         |   |   Load R5   |     |                       |                       |</span>
<span class="go">|    |         |         |   |   firmware  |     |                       |                       |</span>
<span class="go">|    |         |         |   +-------------+     |                       |                       |</span>
<span class="go">|    |         |&lt;--------|---| Start A72   |     |                       |                       |</span>
<span class="go">|    |         |         |   | and jump to |     |                       |                       |</span>
<span class="go">|    |         |         |   | DM fw image |     |                       |                       |</span>
<span class="go">|    |         |         |   +-------------+     |                       |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |---------|-----------------------|----&gt;| Reset rls |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |  TIFS   |         |                       |          :            |                       |</span>
<span class="go">|    |Services |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|----&gt;|*ATF/OPTEE*|     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |         |                       |          :            |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|----&gt;| *A72 SPL* |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |         |                       |     |   Load    |     |                       |</span>
<span class="go">|    |         |         |                       |     | u-boot.img|     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |         |                       |          :            |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|----&gt;| *U-Boot*  |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |         |                       |     |  prompt   |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |         |                       |     |  Load R5  |     |                       |</span>
<span class="go">|    |         |         |                       |     |  Firmware |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|-----|  Start R5 |     |      +-----------+    |</span>
<span class="go">|    |         |---------|-----------------------|-----+-----------+-----|-----&gt;| R5 starts |    |</span>
<span class="go">|    |         |         |                       |     |  Load C6  |     |      +-----------+    |</span>
<span class="go">|    |         |         |                       |     |  Firmware |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|-----|  Start C6 |     |      +-----------+    |</span>
<span class="go">|    |         |---------|-----------------------|-----+-----------+-----|-----&gt;| C6 starts |    |</span>
<span class="go">|    |         |         |                       |     |  Load C7  |     |      +-----------+    |</span>
<span class="go">|    |         |         |                       |     |  Firmware |     |                       |</span>
<span class="go">|    |         |         |                       |     +-----------+     |                       |</span>
<span class="go">|    |         |&lt;--------|-----------------------|-----|  Start C7 |     |      +-----------+    |</span>
<span class="go">|    |         |---------|-----------------------|-----+-----------+-----|-----&gt;| C7 starts |    |</span>
<span class="go">|    +---------+         |                       |                       |      +-----------+    |</span>
<span class="go">|                        |                       |                       |                       |</span>
<span class="go">+------------------------------------------------------------------------+-----------------------+</span>
</pre></div>
</div>
<p>Here DMSC acts as master and provides all the critical services. R5/ARM64
requests DMSC to get these services done as shown in the above diagram.</p>
</div>
<div class="section" id="u-boot-environment">
<h2><span class="section-number">3.1.1.1.5. </span>U-Boot Environment<a class="headerlink" href="#u-boot-environment" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SDK 9.0 will not default to the environments that are saved on the boards,
It will default to the ones that are given with the particular uboot in
the release.</p>
</div>
<p>By default the SDK builds will have the default environments whenever being
run, to have some custom environments, one needs to rely on uEnv.txt
file.</p>
<p>The added benefit of using uEnv.txt is that it is more granular than the
saveenv counterpart as we can choose to store the variables that are
actually being set during the development workflow.</p>
<p><strong>Writing to MMC/EMMC</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=&gt; env export -t $loadaddr &lt;list of variables&gt;
=&gt; fatwrite mmc ${mmcdev} ${loadaddr} ${bootenvfile} ${filesize}
</pre></div>
</div>
<p>The following will update the uEnv.txt file on the bootmedia and then
whenever “run envboot” is run on the board, uEnv.txt will be read based on
mmcdev value to be read either from emmc/sd card.</p>
<p>You can specifically choose the variables that you are changing in your
development process so that the other variables are not affected due to the
whole environment being saved. Optionally, one can save the full
environment too in uEnv.txt by not specifying &lt;list of variables&gt; this
will have some issues with the ethernet mac addresses not being overridden
but other things will be set.</p>
<p><strong>Reading from MMC/EMMC</strong></p>
<p>By default run envboot will read it from the MMC/EMMC partition ( based on
mmcdev) and set the environments.</p>
<p>If manually needs to be done then the environment can be read from the
filesystem and then imported</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=&gt; fatload mmc ${mmcdev} ${loadaddr} ${bootenvfile}
=&gt; env import -t ${loadaddr} ${filesize}
</pre></div>
</div>
<p>For production environments if one needs to rely on saveenv counterpart
then they can always refer to the <a class="reference external" href="https://git.ti.com/cgit/ti-u-boot/ti-u-boot/commit/?h=ti-u-boot-2023.04-next&amp;id=949e9cf709391136aa9a7a7f2c2215a9855261ef">commit</a></p>
<p class="rubric" id="networking-environment">Networking Environment</p>
<p>When using a USB-Ethernet dongle a valid MAC address must be set in the
environment. To create a valid address please read <a class="reference external" href="http://www.denx.de/wiki/view/DULG/WhereCanIGetAValidMACAddress">**this
page**</a>.
Then issue the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>U-Boot # setenv usbethaddr value:from:link:above
</pre></div>
</div>
<p>You can use the <strong>printenv</strong> command to see if <strong>usbethaddr</strong> is already
set.</p>
<p>Then start the USB subsystem:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>U-Boot # usb start
</pre></div>
</div>
<p>The default behavior of U-Boot is to utilize all information that a DHCP
server passes to us when the user issues the <strong>dhcp</strong> command. This will
include the dhcp parameter <em>next-server</em> which indicates where to fetch
files from via TFTP. There may be times however where the dhcp server on
your network provides incorrect information and you are unable to modify
the server. In this case the following steps can be helpful:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>U-Boot # setenv autoload no
U-Boot # dhcp
U-Boot # setenv serverip correct.server.ip
U-Boot # tftp
</pre></div>
</div>
<p>Another alternative is to utilize the full syntax of the tftp command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>U-Boot # setenv autoload no
U-Boot # dhcp
U-Boot # tftp ${loadaddr} server.ip:fileName
</pre></div>
</div>
</div>
<div class="section" id="available-ram-for-image-download">
<h2><span class="section-number">3.1.1.1.6. </span>Available RAM for image download<a class="headerlink" href="#available-ram-for-image-download" title="Permalink to this headline">¶</a></h2>
<p>To know the amount of RAM available for downloading images or for other
usage, use <code class="docutils literal notranslate"><span class="pre">bdinfo</span></code> command.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=&gt; bdinfo
arch_number = 0x00000000
boot_params = 0x80000100
DRAM bank   = 0x00000000
-&gt; start    = 0x80000000
-&gt; size     = 0x7F000000
baudrate    = 115200 bps
TLB addr    = 0xFEFF0000
relocaddr   = 0xFEF30000
reloc off   = 0x7E730000
irq_sp      = 0xFCEF8880
sp start    = 0xFCEF8870
Early malloc usage: 890 / 2000
</pre></div>
</div>
<p>After booting, U-Boot relocates itself (along with its various reserved
RAM areas) and places itself at end of available RAM (starting at
<code class="docutils literal notranslate"><span class="pre">relocaddr</span></code> in <code class="docutils literal notranslate"><span class="pre">bdinfo</span></code> output above). Only the stack is located
just before that area. The address of top of the stack is in
<code class="docutils literal notranslate"><span class="pre">sp</span> <span class="pre">start</span></code> in <code class="docutils literal notranslate"><span class="pre">bdinfo</span></code> output and it grows downwards. Users should
reserve at least about 1MB for stack, so in the example output above,
RAM in the range of <code class="docutils literal notranslate"><span class="pre">[0x80000000,</span> <span class="pre">0xFCE00000]</span></code> is safely available for
use.</p>
</div>
<div class="section" id="device-trees">
<h2><span class="section-number">3.1.1.1.7. </span>Device Trees<a class="headerlink" href="#device-trees" title="Permalink to this headline">¶</a></h2>
<p>A note about device trees. Now all supported boards are required to use a
device tree to boot. To facilitate this in supported platforms, a command
in U-Boot environment <strong>findfdt</strong> is available that will set the <strong>fdtfile</strong>
variable to the name of the device tree to use, as found with the kernel
sources. In the Keystone-2 family devices (K2H/K/E/L/G), it is specified
by <strong>name_fdt</strong> variable for each platform. The device tree is expected
to be loaded from the same media as the kernel, and from the same relative path.</p>
</div>
<div class="section" id="sram-memory-layout-during-r5-spl-bootloader-stage">
<span id="am64-sram-layout-label"></span><h2><span class="section-number">3.1.1.1.8. </span>SRAM memory Layout during R5 SPL bootloader stage<a class="headerlink" href="#sram-memory-layout-during-r5-spl-bootloader-stage" title="Permalink to this headline">¶</a></h2>
<p>The SRAM memory layout explains the memory used for Bootloader’s operation.</p>
<blockquote>
<div></div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="UG-DFU.html" class="btn btn-neutral float-right" title="3.1.1.2. USB Device Firmware Upgrade (DFU)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Users-Guide.html" class="btn btn-neutral" title="3.1.1. User’s Guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <a href="http://www.ti.com/corp/docs/legal/copyright.shtml">&copy; Copyright 1995-2023</a>, Texas Instruments Incorporated. All rights reserved. <br>
      <a href="http://www.ti.com/corp/docs/legal/trademark/trademrk.htm">Trademarks</a> | <a href="http://www.ti.com/corp/docs/legal/privacy.shtml">Privacy policy</a> | <a href="http://www.ti.com/corp/docs/legal/termsofuse.shtml">Terms of use</a> | <a href="http://www.ti.com/lsds/ti/legal/termsofsale.page">Terms of sale</a>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'09_00_00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
        });

      var menuHeight = window.innerHeight;

      var contentOffset = $(".wy-nav-content-wrap").offset();
      var contentHeight = $(".wy-nav-content-wrap").height();
      var contentBottom = contentOffset.top + contentHeight;

      function setNavbarTop() {
          var scrollTop = $(window).scrollTop();
          var maxTop = scrollTop + menuHeight;

          // If past the header
          if (scrollTop > contentOffset.top && maxTop < contentBottom) {
            stickyTop = scrollTop - contentOffset.top;
          } else if (maxTop > contentBottom) {
            stickyTop = scrollTop - contentOffset.top - (maxTop - contentBottom);
          } else {
            stickyTop = 0;
          }

          $(".wy-nav-side").css("top", stickyTop);
      }

      $(document).ready(function() {
        setNavbarTop();
        $(window).scroll(function () {
          setNavbarTop();
        });

        $('body').on("mousewheel", function () {
            // Remove default behavior
            event.preventDefault();
            // Scroll without smoothing
            var wheelDelta = event.wheelDelta;
            var currentScrollPosition = window.pageYOffset;
            window.scrollTo(0, currentScrollPosition - wheelDelta);
        });
      });
  </script>
   

</body>
</html>